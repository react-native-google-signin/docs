---
sidebar_position: 30
sidebar_class_name: sponsor-heart
---

import Image from "@theme/IdealImage";

# One-tap Google sign in

This is the easiest and recommended way to implement Google Sign In. It is a sign in flow that (on Android) requires very little user interaction, thus increasing conversions. This api is available on Android, iOS, macOS and Web (with a little extra work [described below](#web-support)).

- On Android, it is built on top of the [Credential Manager](https://developers.google.com/identity/android-credential-manager).

- On iOS and macOS, the provided API is a wrapper of the [iOS Google Sign In SDK](https://developers.google.com/identity/sign-in/ios/start-integrating), same as the [Original Google Sign In](original). This is so that you can use the same API for both Android and iOS.

- On the Web, it covers both the [One-tap](https://developers.google.com/identity/gsi/web/guides/offerings#one_tap) flow and the [Google Sign-In button](https://developers.google.com/identity/gsi/web/guides/offerings#sign_in_with_google_button).

:::tip
The functionality covered in this page is only available to sponsors️. [It takes just a few clicks to get access](install#accessing-the-private-package-for-sponsors) ❤️.

This module is being actively developed, and new features are added regularly. Since the first release in July 2023, there has been more than 1 release per month on average (last updated in May 2024).
:::

Note that on iOS and Android, you can combine the one-tap methods with those one from the [Original Google Sign In](original). To do that, use the One-tap sign in to sign in the user. Then call `signInSilently()` and then (for example) `getCurrentUser()` to get the current user's information. However, this shouldn't be necessary because this module should cover all your needs. Please open an issue if that's not the case.

```ts title="example of importing the module"
import {
  GoogleOneTapSignIn,
  statusCodes,
  type OneTapUser,
} from "@react-native-google-signin/google-signin";
```

### `signIn`

signature: (`params`: [`OneTapSignInParams`](api#onetapsigninparams)) => `Promise`\<[`OneTapUser`](api#onetapuser)\>

| Platform | Behavior                                                                                                                                                                                                                                                    |
| -------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Android  | Attempts to sign in user automatically. [Docs](<https://developers.google.com/identity/android-credential-manager/android/reference/kotlin/com/google/android/libraries/identity/googleid/GetGoogleIdOption.Builder#setAutoSelectEnabled(kotlin.Boolean)>). |
| iOS      | Attempts to restore a previous user sign-in without interaction. [Docs](https://developers.google.com/identity/sign-in/ios/reference/Classes/GIDSignIn#-restoreprevioussigninwithcompletion:).                                                              |
| Web      | This call rejects - please [read below](#web-support) for web support.                                                                                                                                                                                      |

Returns a `Promise` that resolves with an object containing the user data or rejects in case of error. If there is no user that previously signed in, the promise will reject with [`NO_SAVED_CREDENTIAL_FOUND`](errors#status-codes-specific-to-one-tap-sign-in) error. In that case, you can call [`createAccount`](one-tap#createaccount) to start a flow to create a new account. You don't need to call `signIn` as a response to a user action - you can call it when your app starts or when suitable.


<details>
  <summary>UI screenshot</summary>
|                                                                                      Android                                                                                      |             iOS              |
| :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: | :--------------------------: |
| No UI, no user interaction the first time. If user has signed up previously, they will see this: <br/> <img src={'/img/onetap/signing-in-android.png'} style={{maxWidth: 400}} /> | (no UI, no user interaction) |

</details>

```ts
import {
  GoogleOneTapSignIn,
  statusCodes,
  isErrorWithCode,
  GoogleSignin,
} from "@react-native-google-signin/google-signin";

// Somewhere in your code
const signIn = async () => {
  try {
    await GoogleSignin.hasPlayServices();
    const userInfo = await GoogleOneTapSignIn.signIn({
      webClientId: config.webClientId,
      iosClientId: config.iosClientId, // only needed if you're not using the Firebase config file
      nonce: "your_nonce",
    });
    setState({ userInfo });
  } catch (error) {
    if (isErrorWithCode(error)) {
      switch (error.code) {
        case statusCodes.NO_SAVED_CREDENTIAL_FOUND:
          // Android only. No saved credential found, try calling `createAccount`
          break;
        case statusCodes.SIGN_IN_CANCELLED:
          // sign in was cancelled
          break;
        case statusCodes.ONE_TAP_START_FAILED:
          // Android and Web only, you probably have hit rate limiting.
          // On Android, you can still call `presentExplicitSignIn` in this case.
          // On the web, user needs to click the `WebGoogleSigninButton` to sign in.
          break;
        case statusCodes.PLAY_SERVICES_NOT_AVAILABLE:
          // Android-only: play services not available or outdated
          break;
        default:
        // something else happened
      }
    } else {
      // an error that's not related to google sign in occurred
    }
  }
};
```

### `createAccount`

signature: (`params`: [`OneTapSignInParams`](api#onetapsigninparams)) => `Promise`\<[`OneTapUser`](api#onetapuser)\>

| Platform | Behavior                                                                                                                                                                                                                                                                                            |
| -------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Android  | Starts a flow to sign in with your app for the first time (to create a user account). It offers a list of user accounts to choose from (multiple Google accounts can be logged in on the device).                                                                                                   |
| iOS      | Starts an interactive sign-in flow on iOS. [Docs](https://developers.google.com/identity/sign-in/ios/reference/Classes/GIDSignIn#-signinwithpresentingviewcontroller:hint:completion:). It offers a list of user accounts to choose from (multiple Google accounts can be logged in on the device). |
| Web      | This call rejects - please [read below](#web-support) for web support.                                                                                                                                                                                                                              |

You don't need to call `createAccount` as a response to a user action - you can call it some time after your app starts (the way the dialog is presented on iOS might be inconvenient to users) or when suitable.

Use `createAccount` if `signIn` rejected with [`NO_SAVED_CREDENTIAL_FOUND`](errors#status-codes-specific-to-one-tap-sign-in) error, as shown in the code snippet above.

Returns a `Promise` that resolves with an object containing the user data or rejects in case of error.

<details>
  <summary>UI screenshot</summary>

|                                  Android                                   |                                  iOS                                   |
| :------------------------------------------------------------------------: | :--------------------------------------------------------------------: |
| <img src={'/img/onetap/signing-up-android.png'} style={{maxWidth: 400}} /> | <img src={'/img/onetap/signing-up-ios.png'} style={{maxWidth: 400}} /> |

</details>

```ts
await GoogleOneTapSignIn.createAccount({
  webClientId: config.webClientId,
  nonce: "your_nonce",
});
```

### `presentExplicitSignIn`

✨since v14.2.0

signature: (`params`: [`OneTapSignInParams`](api#onetapsigninparams)) => `Promise`\<[`OneTapUser`](api#onetapuser)\>

| Platform | Behavior                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| -------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Android  | Presents the sign in dialog explicitly. This is useful when the user has hit rate limiting ([`ONE_TAP_START_FAILED`](errors#status-codes-specific-to-one-tap-sign-in)) and the one-tap flow is thus not available, or if both `signIn` and `createAccount` reject with `NO_SAVED_CREDENTIAL_FOUND` error - which happens on Android (in the unlikely case) when no Google account is present on the device. This will prompt the user to add a Google account. |
| iOS      | Starts an interactive sign-in flow on iOS, same as `createAccount`.                                                                                                                                                                                                                                                                                                                                                                                            |
| Web      | This call rejects - please [read below](#web-support) for web support.                                                                                                                                                                                                                                                                                                                                                                                         |

Call this method only as a reaction to when user taps a "sign in with Google" button.

<details>
  <summary>UI screenshot</summary>

|                                 Android                                  |                                  iOS                                   |
| :----------------------------------------------------------------------: | :--------------------------------------------------------------------: |
| <img src={'/img/onetap/explicit-android.png'} style={{maxWidth: 400}} /> | <img src={'/img/onetap/signing-up-ios.png'} style={{maxWidth: 400}} /> |

</details>

```ts
await GoogleOneTapSignIn.presentExplicitSignIn({
  webClientId: config.webClientId,
  nonce: "your_nonce",
});
```

### `signOut`

signature: (`emailOrUniqueId`: `string`) => `Promise`\<`null`\>

Signs out the current user. On the web, you need to provide the `id` or email of the user. On Android and iOS, this parameter does not have any effect.

Returns a Promise that resolves with `null` or rejects in case of error.

```ts
await GoogleOneTapSignIn.signOut(user.id);
```

### `requestAuthorization`

✨since v15.0.0

signature: (`params`: [`RequestAuthorizationParams`](api#requestauthorizationparams)) => `Promise`\<[`AuthorizationResponse`](api#authorizationresponse)\>

The underlying Android SDK separates authentication and authorization. This method is used to request extra authorization from the user.

Use this on Android to obtain server-side access (offline access) to the user's data or for requesting an access token that has access to additional scopes (The default requested scopes are `email` and `profile`.).

| Platform | Behavior                                                                                                                                                                                                                                   |
| -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Android  | Presents a modal that asks user for additional access to their Google account. Uses [AuthorizationRequest.Builder](https://developers.google.com/android/reference/com/google/android/gms/auth/api/identity/AuthorizationRequest.Builder). |
| iOS      | Calls [`addScopes`](./original.md#addscopes). If you need server-side access, specify `offlineAccess: true` in `createAccount`.                                                                                                            |
| Web      | Not implemented yet - please [read below](#web-support) for web support.                                                                                                                                                                   |

> There are minor differences between the Android and iOS implementations stemming from the underlying Google SDKs. For example, iOS will return all granted scopes, while Android may only return the requested scopes.

<details>
    <summary>UI screenshot</summary>
    |                                  Android                                  |                                  iOS                                   |
    | :-----------------------------------------------------------------------: | :--------------------------------------------------------------------: |
    | <img src={'/img/onetap/authorize-android.jpg'} style={{maxWidth: 400}} /> | <img src={'/img/onetap/add-scopes-ios.png'} style={{maxWidth: 400}} /> |

</details>

## Web support

Providing a unified API for the web is a bit more complex than it may seem. This is because the web experience is quite different from the mobile one, and so are the underlying apis.

The `WebGoogleOneTapSignIn.signIn` function exists to handle the web-specific logic. Its interface is as close as possible to the native one, allowing to reuse the logic for both success and error handling across all platforms.

To implement web support, follow these steps:

1. Call `WebGoogleOneTapSignIn.signIn` upon page load. This will attempt to present the One-tap UI. It also sets up a listener for authentication events and calls the `onSuccess` callback when the user signs in (either with One-tap flow or the Sign-In button).

:::warning
You should display the One Tap UI on page load or other window events, instead of it being displayed by a user action (e.g. a button press). Otherwise, you may get a broken UX. Users may not see any UI after a user action, due to [globally opt-out](https://developers.google.com/identity/gsi/web/guides/features#globally_opt_out), [cool-down](https://developers.google.com/identity/gsi/web/guides/features#exponential_cooldown), or no Google session.
:::

```ts
useEffect(() => {
  if (Platform.OS === "web") {
    WebGoogleOneTapSignIn.signIn(
      {
        webClientId: config.webClientId,
      },
      {
        onError: (error: NativeModuleError) => {
          // this might be cancellation, one-tap rate limiting, or other errors
        },
        onSuccess: (userInfo: OneTapUser) => {
          // user has signed in, do something with the user info
        },
        momentListener: (moment) => {
          // optional
        },
      },
    );
  }
}, []);
```

Optionally, you can provide a `momentListener` callback function. The callback is called when important events take place. [See reference.](https://developers.google.com/identity/gsi/web/reference/js-reference#PromptMomentNotification)

2. Render the [`WebGoogleSigninButton`](buttons/web.md) component

One-tap UI may not always be available: This happens if user has [opted out](https://developers.google.com/identity/gsi/web/guides/features#globally_opt_out) or when they cancel the dialog several times in a row, entering the [cooldown period](https://developers.google.com/identity/gsi/web/guides/features#exponential_cooldown).

`WebGoogleSigninButton` serves as a fallback. Tapping it will open the regular Google Sign-In dialog. When user signs in, the `onSuccess` callback will be called.

:::info
The reason the `WebGoogleOneTapSignIn.signIn` api is callback-based rather than promise-based is that it's possible to get into an "error" state (when one-tap is not available) and later get a successful sign in from the button flow. Because of how the Google Sign In for Web SDK is done, modeling this with a promise-based api is not possible. In a future release, there will be a single function that supports both the Promise and callback-based usage.
:::
